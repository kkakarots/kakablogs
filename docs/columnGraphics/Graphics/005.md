# 光栅化(Rasterization Cont)
:::tip 关于
Antialiasing and Z-Buffering (反走样(抗锯齿)和深度缓冲)

**锯齿的学名:走样**

- Antialiasing (反走样)
    - Sampling theory (采样理论)
    - Antialiasing in practice (实践中的反走样 )
- Visibility / occlusion (可见性/遮挡)
    - Z-buffering
:::

## Sampling Artifacts (Errors / Mistakes / Inaccuracies) in Computer Graphics

:::info Artifacts due to sampling - “Aliasing” (采样产生的伪影——“混叠”)
1. Jaggies (Staircase Pattern) 锯齿(楼梯形状)
<img src="./images/锯齿-1.png" style="margin: 2px auto;">

2. Moiré Patterns in Imaging (摩尔纹)

**Skip odd rows and columns (跳过奇数行和奇数列)**

<img src="./images/摩尔纹.png" style="margin: 2px auto;">

3. Wagon Wheel Illusion (False Motion) (车轮错觉(假动作))

人眼在时间上的采样跟不上运动的速度

<img src="./images/车轮错觉.png" style="margin: 2px auto;">

4. [Many more]...
:::

::: tip Behind the Aliasing Artifacts (原因)
- Signals are changing too fast (high frequency), but sampled too slowly (信号变化太快(高频)但采样太慢)
:::

## 解决方案

Antialiasing Idea: Blurring (Pre-Filtering) Before Sampling (抗锯齿思想:采样之前做模糊(预滤波))

<img src="./images/预模糊.png" style="margin: 2px auto;">

:::info Point Sampling vs Antialiasing (点采样 vs 抗锯齿)



<div style="display:flex">
    <img src="./images/xg-1.png" style="margin: 2px auto; max-width: 40%;" title="Point Sampling(点采样)">
    <img src="./images/xg-2.png" style="margin: 2px auto; max-width: 40%;" title="Antialiasing(反走样)">
</div>

---

<div style="display:flex">
    <img src="./images/xg-3.png" style="margin: 2px auto; max-width: 40%;">
    <img src="./images/xg-4.png" style="margin: 2px auto; max-width: 40%;">
</div>

---

Antialiasing vs Blurred Aliasing

Sample then filter, WRONG!

<div style="display:flex">
    <img src="./images/xg-5.png" style="margin: 2px auto; max-width: 40%;" title="Blurred Aliasing">
    <img src="./images/xg-4.png" style="margin: 2px auto; max-width: 40%;" title="Antialiasing(反走样)">
</div>

:::

:::warning But Why?
1. Why undersampling introduces aliasing?
2. Why pre-filtering then sampling can do antialiasing?

Let’s dig into fundamental reasons 
And look at how to implement antialiased rasterization
:::

## Frequency Domain (频域)

::: info Sines and Cosines

<img src="./images/cos.png" style="margin: 2px auto;">

$$ \cos{2 \pi x} $$

<img src="./images/sin.png" style="margin: 2px auto;">

$$ \sin{2 \pi x} $$

:::

::: info Frequencies (频率)

<img src="./images/cos.png" style="margin: 2px auto;">

$$ \cos{2 \pi x} $$ 
$$ f=1 $$

<img src="./images/cos4.png" style="margin: 2px auto;">

$$ \cos{4 \pi x} $$ 
$$ f=2 $$
---
$$ \cos{2 \pi fx} $$
$$ f=\frac{1}{T} $$
:::

::: info Fourier Transform (傅里叶变换)


:::
::: info (滤波)


:::

